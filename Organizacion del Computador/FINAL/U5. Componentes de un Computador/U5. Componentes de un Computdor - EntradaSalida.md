# U5 - Componentes de un computador: Entrada/Salida

## Modulo de E/S
![es](https://github.com/user-attachments/assets/c4ab9d42-27f7-4853-833d-37454298d2a6) <br>

### Â¿Por que existe?
Porque cada periferico tiene formas de comunicacion, formas de transferencias de datos, tecnologia, velocidad de transferencia de informacion, etc, distintas, entonces el modulo E/S lidia con esa complejidad para que no lo tenga que hacer el CPU.
- Amplia variedad de perifÃ©ricos con distintos mÃ©todos de operaciÃ³n
- La tasa de transferencia de los perifÃ©ricos es generalmente mucho mÃ¡s lenta que la de la memoria y procesador
- Los perifÃ©ricos usan distintos formatos de datos y tamaÃ±os de palabra
### Â¿Para que sirve?
Oculta detalles de timing, formatos y electro mecÃ¡nica de los dispositivos perifÃ©ricos
### Â¿Que hace?
Conecta a los perifÃ©ricos con la CPU y la memoria a travÃ©s del bus del sistema o switch central y permite la comunicaciÃ³n entre ellos. <br>
Lo que va a intercambia el modulo E/S con los perifericos son datos, informacion de control y el estado de los perifericos (ej una impresora que se le trabo el papel).

![es](https://github.com/user-attachments/assets/b9143982-8164-4ab2-9cc5-31ebe040d432) <br>

## Funciones 
- **Control y Timing:** controla el flujo de trafico entre CPU/Memoria y perifericos. Todo el tiempo controla el flujo de informacion (ej. transmision inalambrica constante de un audio captado por un microfono).
- **Comunicacion con el procesador:**
    * Decodificacion de comandos: un comando generico se traduce en comandos especificos para el procesador.
    * Datos: se transmiten datos desde el CPU al periferico (ej. imprimir una imagen: la imagen viaja en forma de byte a traves de la E/S, a traves de la forma que tenga de comunicarse con la impresora (inalambrico o por cable) y llegan los bytes que componen la imagen hasta la impresora).
    * Informacion de estado: el CPU puede leer el estado de un periferico.
    * Reconocimiento de direcciones: todos los perifericos conectados tienen un ID unico entonces el CPU sabe que ID usar para comunicarse con ese periferico.
- **Comunicacion con el dispositivo:** que intercambia el modulo E/S con el dispositivo
    * Comandos: por ejemplo, a un disco rigido le puede llegar la directiva de grabar tal conjunto de bytes en tal posicion del disco. O decirle a una impresora que imprima tal imagen que esta en una direccion de memoria.
    * Informacion de estado: 
    * Datos: por ej un teclado envia que tecla se presiono.
- **Buffering de datos:** refiere al resguardo de datos temporal para transmitirlos en el momento adecuado. Es el proceso de almacenar temporalmente datos en un Ã¡rea de memoria conocida como "buffer" antes de que sean procesados o transmitidos. Este almacenamiento temporal permite manejar diferencias en las tasas de procesamiento entre dos entidades que producen y consumen los datos, como puede ser entre un dispositivo de entrada/salida y el CPU
- **Deteccion de errores:** tiene que ver con la trasmision del estado. El modulo E/S detecta si hay una codicion de error.

## Estructura del modulo E/S
![esq](https://github.com/user-attachments/assets/45c982a8-9db6-4619-9430-e38d6c238408) <br>

- **I/O logic:** controla la transferencia de datos entre los registros internos y el bus del sistema, y entre los registros internos y los perifericos.
- **External device interface logic:** se refiere a la logica de cada periferico al que el modulo E/S le da servicio. Aseguran que los datos se transfieran correctamente y que se respeten los protocolos de comunicacion de cada periferico.
### Interface Interna (bus del sistema)
- **Data lines:** transmite datos entre el procesador y el modulo de E/S. Camino electronico, linea de comunicacion con el CPU y Memoria. Se guardan temporalmente los datos que le quiere mandar el CPU al periferico para que haga algo: *data registers* es el buffer de datos y *status/control registers* guarda momentaneamente parametros adicionales de los comandos que se envian y el estado que el periferico envia
- **Address lines:** lo que intercambia el CPU con el modulo de E/S es el reconocimiento de perifericos a traves de su ID.
- **Control lines:** viaja el comando que el CPU envia de forma generica y el *I/O logic* lo interpreta y lo procesa para que se decodifique para cada periferico.
### Interface Externa (perifericos):
- **Data:** transmite datos entre el mÃ³dulo de E/S y los perifÃ©ricos. Camino electronico hacia la interfaz externa con los dispositivos
- **Status:** proporciona informaciÃ³n sobre el estado de los perifÃ©ricos, como listo para recibir datos, ocupado, etc. El periferico manda el estado.
- **Control:** permite al procesador enviar comandos a los perifÃ©ricos, como iniciar una operaciÃ³n, detenerla, etc. El comando traducido se envia al periferico.

## Tecnicas para operaciones de E/S

### E/S Programada
![a](https://github.com/user-attachments/assets/d21f9125-7558-4b4f-bf17-bf9299d8c7ca)

#### Como funciona cuando un programa esta realizando una operacion de entrada y salida:
1. Un comando generico va desde el CPU hasta el periferico pasando a traves del modulo E/S
2. El CPU se queda esperando una respuesta. `I/O -> CPU`
3. Recibe como respuesta el estado del periferico:
    * Puede no estar listo para recibir el comando (por ej esta terminando otra tarea previa) y el CPU vuelve a quedarse esperando una respuesta. Regresa al paso 2.
    * Puede recibir una condicion de error y derivarse a alguna accion particular.
    * Puede recibir un estado que indique que esta listo. Va al paso 4

A partir de aca significa que el modulo E/S envio la peticion, el periferico la recibio, la realizo y le devolvio la informacion que el CPU queria leer.

4. El modulo E/S le envia al CPU los bytes que el periferico le dejo. `I/O -> CPU`
5. Se guardan los bytes en la memoria. `CPU -> Memory`
6. Termino?
    * No: vuelve al inicio, al paso 1.
    * Si: pasa a la siguiente instruccion.

ðŸŸ¢ Como ventaja esta la simplicidad del modelo.<br>
ðŸ”´ Como desventaja tiene que que es una implementacion ineficiente ya que el CPU se queda esperando comprobando el estado del periferico sin hacer nada mas, entonces se desperdician recursos del procesador.

### E/S manejada por interrupciones
![aada](https://github.com/user-attachments/assets/3525bbe8-cdc2-4560-9f42-a5bce3f17b47) <br>

El CPU se entera que lo que le pidio al modulo E/S en algun momento ocurrio a traves de un componente del hardware del CPU que se identifica como Interrupcion, dedicado a escuchar esa seÃ±al de interrupcion para alertar  al CPU para que deje de hacer lo que esta haciendo, escuche esa interrupcion y la evalue.
1. Se envia el comando.
2. Se va a interrumpir al CPU cuando se reciba la seÃ±al de que se termino la operacion que se le habia pedido y vuelve para gestionar los datos que se recibieron.
     * Se identifica un erro -> se hace algo al respecto.
     * Se identifica un estado listo, se continua al siguiente paso.

Identico al modelo anterior       

3. El modulo E/S le envia al CPU los bytes que el periferico le dejo. `I/O -> CPU`
4. Se guardan los bytes en la memoria. `CPU -> Memory`
5. Termino?
    * No: vuelve al inicio, al paso 1.
    * Si: pasa a la siguiente instruccion.

ðŸŸ¢ Como ventaja esta la mayor eficiencia comparado con el E/S programada, ya que la CPU no desperdicia ciclos de reloj esperando a que se complete la operaciÃ³n de E/S.<br>
ðŸ”´ El manejo frecuente de interrupciones puede afectar el rendimiento del sistema.

### Acceso directo a memoria (DMA)
![DMA](https://github.com/user-attachments/assets/9c23f02e-1e48-45e5-9089-1d2fc6793463) <br>
- El DMA es fisicamente otro circuito.<br>
- El DMA se encarga de capturar el estado del periferico, se encarga de que los bytes viajen desde el periferico al modulo DMA, lee los bytes, los escribe en memoria y cuando ya no hay mas que hacer se emite la Interrupcion que interrumpe al CPU. `DMA -> CPU`

ðŸŸ¢ Libera al CPU de estar involucrada en la transferencia de datos, mejora significativamente la eficiencia del sistema. <br>
ðŸ”´ Requiere hardware adicional (controlador DMA) y puede complicar el diseÃ±o del sistema. AdemÃ¡s, el DMA puede competir con la CPU por el acceso a la memoria, lo que puede afectar el rendimiento.

#### Esquema del DMA
![esq](https://github.com/user-attachments/assets/fad3291e-7ac9-4fd4-885e-fab2153186a1) <br>

